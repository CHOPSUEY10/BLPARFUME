================================================================================
                                  BLPARFUME
                           Project Documentation
================================================================================

1. PROJECT OVERVIEW
-------------------
BLPARFUME is a web-based e-commerce application designed for selling perfume products. 
It features a public-facing shop for customers and a comprehensive admin panel 
for management.

2. TECHNOLOGY STACK
-------------------
- Backend Framework: CodeIgniter 4 (PHP)
- Database: MySQL
- Frontend: 
  - HTML5 & CSS3
  - Tailwind CSS (Utility-first CSS framework)
  - JavaScript (Alpine.js, SweetAlert2, Chart.js)
- Server: Apache/Nginx (via XAMPP/WAMP or built-in Spark)

3. KEY FEATURES
-------------------
[A] Public Area (Customer)
    - Home Page: Hero section, featured products.
    - Shop (Belanja): Browse all perfume products.
    - Cart (Keranjang): Add items, manage quantities, checkout.
    - History (Riwayat): View past purchase history.
    - Contact (Kontak): Send messages/inquiries to admin.
    - Authentication: User Login and Registration.

[B] Admin Dashboard
    - Dashboard Overview: Statistics for sales, orders, and products.
    - Order Management: View incoming orders, update status (Pending/Process/Done).
    - Transaction History: Log of completed sales.
    - Finance (Keuangan): Financial summaries (Monthly/Yearly reports).
    - Message Box (Kotak Masuk): View and manage messages from the Contact form.
    - Product Management: CRUD (Create, Read, Update, Delete) products with image upload.

4. RECENT UPDATES & FIXES
-------------------------
- [New] Order Cancellation: Implemented order cancellation feature with status update to 'cancel' in database.
  - Added cancelOrder endpoint in Dashboard controller with logging for diagnostics.
  - Updated all admin views (Pesanan, Transaksi, Dashboard) to properly display cancelled orders as "Dibatalkan".
  - Cancel action links hidden once order is cancelled to prevent duplicate cancellations.
  - Server-side logging for admin user, order ID, and operation results in writable/logs.

- [New] Stock Management: Added product stock tracking system.
  - Database migration added 'stock' column to products table (INT, default 0).
  - Product create/edit forms now include stock input field.
  - Admin product view displays stock quantity with color coding (green for > 0, red for 0).
  - Stock field included in all product CRUD operations.

- [Fix] Admin Exports: Added CSV export functionality for Orders, Transactions, Products, and Finances.
- [Fix] Admin Pagination: Implemented dynamic pagination (counting total rows) for Orders, Transactions, and Products views to replace hardcoded values.
- [Fix] Cart Functionality: Fixed cart update and delete buttons using AJAX.
- [New] Admin Filters Standardized: Implemented GET-based filters for Orders, Transactions, and Products.
  - Server-side filtering for search, status, date range (from/to) parameters.
  - Filter values persist across pagination.
  - Date-range filtering implemented in AdminModel queries.

- [New] Financial Dashboard Enhancements:
  - Added DB-driven financial metrics: total revenue, unique customers, CLV, repeat purchase rate, ROI.
  - Monthly breakdown with revenue, costs, profit, and profit margin calculations.
  - Year selector for monthly sales chart on dashboard.
  - Full numeric Rupiah formatting across all admin pages (removed M/K shorthand).

- [Previous] Contact Feature: 
  - Implemented secure message submission form.
  - Added 'messages' database table.
  - Created Admin Interface to view and delete received messages.

- [Previous] Admin Product Delete: Resolved 403 Forbidden error by implementing CSRF token handling in AJAX.

5. SYSTEM REQUIREMENTS
----------------------
- PHP Version: 7.4 or newer (8.1+ recommended)
- MySQL/MariaDB
- Composer (for dependency management)

6. SETUP & INSTALLATION
-----------------------
1. Configure Database:
   - Create a database named `BLPARFUME`.
   - Update `app/Config/Database.php` or `.env` with your credentials.

2. Run Migrations (to create tables):
   > php spark migrate

3. Start Development Server:
   > php spark serve

4. Access the application:
   - URL: http://localhost:8080

================================================================================
Generated by AI Assistant
Date: 2025-12-11 (Updated with stock management, order cancellation, and financial enhancements)
================================================================================
